<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pazport to English | Slytherin Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=EB+Garamond:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --slytherin-green: #1A472A;
            --slytherin-silver: #AAAAAA;
            --deep-black: #111111;
            --parchment: #F5F5DC;
            --light-parchment: #FFFEF7;
            --gold-accent: #C0C0C0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'EB Garamond', serif;
            background-color: var(--deep-black);
            background-image: url('https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-blend-mode: multiply;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 20px auto;
            background-color: var(--parchment);
            background-image: radial-gradient(#c9b18a 1px, transparent 1px);
            background-size: 20px 20px;
            border: 12px solid var(--slytherin-green);
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            border-radius: 12px;
            overflow: hidden;
            border-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" fill="none" stroke="%231A472A" stroke-width="10"/></svg>') 30 stretch;
        }

        .screen { min-height: 75vh; padding: 40px; text-align: center; }
        .hidden { display: none !important; }

        h1, h2, h3 { font-family: 'Cinzel', serif; color: var(--slytherin-green); margin-bottom: 20px; text-transform: uppercase; }
        
        /* FIX: Mobile "Achievement" text overflow */
        h1 { font-size: 3.2rem; letter-spacing: 2px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem !important; } 
            .screen { padding: 20px; }
            .flashcard { height: 280px; }
            .front h3 { font-size: 2rem; }
        }

        .input-group { margin: 25px 0; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto; }
        .input-group label { display: block; font-family: 'Cinzel', serif; margin-bottom: 10px; color: var(--slytherin-green); font-weight: 900; }
        
        input[type="text"], select {
            width: 100%; padding: 18px; border: 4px solid var(--slytherin-green);
            background: var(--light-parchment); border-radius: 6px; font-size: 1.2rem;
            font-family: 'EB Garamond', serif; font-weight: 600;
        }

        .btn {
            display: inline-block; padding: 18px 36px;
            background: linear-gradient(to bottom, var(--slytherin-green), #0d2b1a);
            color: var(--gold-accent) !important;
            border: 2px solid var(--slytherin-silver);
            border-radius: 6px; font-family: 'Cinzel', serif;
            font-weight: 700; cursor: pointer; text-transform: uppercase;
            box-shadow: 0 6px 0 #000; transition: 0.2s; letter-spacing: 1px;
        }

        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 0 #000; filter: brightness(1.2); }
        .btn:active { transform: translateY(2px); box-shadow: 0 2px 0 #000; }
        .btn:disabled { background: #444; cursor: not-allowed; opacity: 0.6; box-shadow: none; transform: none; }

        .activity-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 30px; margin-top: 40px; }
        .activity-card {
            background: var(--light-parchment); border: 5px solid var(--slytherin-green);
            padding: 30px; border-radius: 10px; cursor: pointer; transition: 0.4s;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); position: relative;
        }
        .activity-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px var(--slytherin-green); }

        /* FIX: Re-integrated Completion Seals */
        .seal { position: absolute; top: 10px; right: 10px; color: var(--slytherin-green); font-size: 1.5rem; }

        .flashcard { width: 100%; max-width: 500px; height: 320px; margin: 30px auto; perspective: 1000px; cursor: pointer; }
        .flashcard-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
        
        .front, .back {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-radius: 15px; border: 8px solid var(--slytherin-silver); padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }
        
        .front { background-color: var(--slytherin-green) !important; }
        .front h3 { 
            color: #FFFFFF !important; 
            font-family: 'Cinzel', serif; 
            font-size: 2.8rem; 
            text-shadow: 3px 3px 6px rgba(0,0,0,0.9);
            text-align: center;
        }
        
        .back { background-color: var(--slytherin-silver) !important; transform: rotateY(180deg); }
        .back p { 
            color: var(--slytherin-green) !important; 
            font-family: 'EB Garamond', serif;
            font-size: 1.6rem; 
            font-weight: 700; 
            line-height: 1.3;
            text-align: center;
        }

        .quiz-option {
            background: var(--light-parchment); border: 3px solid var(--slytherin-green);
            padding: 16px; margin: 12px auto; max-width: 650px; cursor: pointer; border-radius: 8px;
            font-family: 'EB Garamond', serif; font-size: 1.3rem; font-weight: 600; transition: 0.2s;
        }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724 !important; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24 !important; }
    </style>
</head>
<body>

<div class="container">
    <section id="screen-home" class="screen">
        <i class="fas fa-shield-snake" style="font-size: 4rem; color: var(--slytherin-green);"></i>
        <h1>Pazport to English</h1>
        <p style="font-size: 1.2rem; color: #555; margin-bottom: 10px;">The Portal of Ambition and Knowledge</p>
        
        <div class="input-group">
            <label>Student Full Name</label>
            <input type="text" id="studentName" placeholder="Type your name..." oninput="updateUnitList()">
        </div>
        
        <div class="input-group">
            <label>Select Your Quest</label>
            <select id="unitSelect" onchange="checkUnitStatus()"></select>
        </div>
        
        <button class="btn" id="enterBtn" onclick="startPortal()">Enter the Dungeons</button>
        <p id="statusMsg" style="margin-top:20px; font-weight:bold; color:var(--slytherin-green); font-family:'Cinzel';"></p>
    </section>

    <section id="screen-menu" class="screen hidden">
        <h2 id="welcome-msg">Slytherin Room</h2>
        <div class="activity-grid">
            <div class="activity-card" onclick="startActivity('scrolls')">
                <div id="seal-scrolls" class="seal hidden"><i class="fas fa-snake"></i></div>
                <i class="fas fa-scroll" style="font-size: 3rem; color: var(--slytherin-green);"></i>
                <h3 style="margin-top:15px;">Study Scrolls</h3>
            </div>
            <div class="activity-card" onclick="startActivity('quiz')">
                <div id="seal-quiz" class="seal hidden"><i class="fas fa-snake"></i></div>
                <i class="fas fa-vial" style="font-size: 3rem; color: var(--slytherin-green);"></i>
                <h3 style="margin-top:15px;">Definition Quiz</h3>
            </div>
            <div class="activity-card" onclick="startActivity('chamber')">
                <div id="seal-chamber" class="seal hidden"><i class="fas fa-snake"></i></div>
                <i class="fas fa-wand-sparkles" style="font-size: 3rem; color: var(--slytherin-green);"></i>
                <h3 style="margin-top:15px;">Sentence Chamber</h3>
            </div>
        </div>
        <button class="btn" onclick="generateCertificate()" style="margin-top: 60px;">Claim Final Report</button>
    </section>

    <section id="screen-activity" class="screen hidden">
        <div style="text-align: left; margin-bottom: 25px;">
            <button class="btn" onclick="showScreen('menu')" style="padding: 10px 20px; font-size: 0.9rem;">Back</button>
        </div>
        <div id="activity-content"></div>
    </section>

    <section id="screen-certificate" class="screen hidden">
        <div id="cert-area" style="border: 15px double var(--slytherin-green); padding: 50px; background: white; border-radius: 10px;">
            <h1 style="text-transform: uppercase;">Mastery Achievement</h1>
            <p style="font-size: 1.4rem;">This recognizes that</p>
            <h2 id="cert-name" style="text-decoration: underline; margin: 20px 0; font-size: 2.8rem; color: #000;"></h2>
            <p style="font-size: 1.4rem;">has conquered the English skills of</p>
            <h3 id="cert-unit" style="margin: 20px 0; color: var(--slytherin-green); font-size: 1.8rem;"></h3>
            <p id="cert-date" style="font-style: italic; font-weight: bold;"></p>
            <div style="margin-top:30px; font-family:monospace; border:2px dashed #333; padding:10px; font-size: 1.1rem;" id="cert-code"></div>
        </div>
        <button class="btn" onclick="location.reload()" style="margin-top: 30px;">Complete Quest</button>
    </section>
</div>

<script>
    const VOCABULARY_DATABASE = {
        "9th - Unit 1 (Part 1)": {
            english: ["Clerk", "Department Store", "Information Desk", "Restroom", "Food Court", "Basement"],
            meanings: ["The person who assists customers in-store.","A large shop divided into several parts selling different types of things.","A place in a public building where you can get information","A room with toilets that is in a public place","A large area inside of a mall where restaurants sell food.","A part of a building that is partially or completely below the level of the ground."],
            sentences: [
                { s: "clerk / The / helped / with / shopping. / my / me", c: "The clerk helped me with my shopping." },
                { s: "To / together / eat / we / go / will / /to / the / food / court", c: "To eat together we will go to the food court" },
                { s: "restroom? / is / where / The", c: "Where is the restroom?" }, 
                { s: "for / Look / scissors / the / are / they / the / in / basement", c: "Look for the scissors they are in the basement" },
                { s: "at / Ask / information / the / desk", c: "Ask at the information desk" },
                { s: "love / I / department / this / store", c: "I love this department store" }
            ]
        },
        "9th - Unit 1 (Part 2)": {
            english: ["Straight", "Toward", "Upstairs", "Direction", "Terrible", "Baseball Cap"],
            meanings: ["No curves.","Direction of.","Higher floor.","Path taken.","Unpleasant.","Soft hat."],
            sentences: [
                { s: "Go / straight / now", c: "Go straight now" },
                { s: "Walk / toward / the / door", c: "Walk toward the door" },
                { s: "Go / upstairs / please", c: "Go upstairs please" },
                { s: "Which / direction / is / it?", c: "Which direction is it?" },
                { s: "This / is / terrible", c: "This is terrible" },
                { s: "I / have / a / baseball cap", c: "I have a baseball cap" }
            ]
        },
        "10th - Unit 1 (Part 1)": {
            english: ["Nervous", "Proud", "Jealous", "Mad", "Lonely", "Afraid"],
            meanings: ["Feeling worried or anxious about something, like an exam.","Feeling very pleased about something you have done.","Unhappy because someone has something you want.","Feeling very angry.","Unhappy because you are not with other people.","Feeling fear or worried about a possible result."],
            sentences: [
                { s: "I / nervous / feel", c: "I feel nervous" },
                { s: "parents / are / My / proud / of / me", c: "My parents are proud of me" },
                { s: "be / jealous / Do / not", c: "Do not be jealous" },
                { s: "mad / very / is / He", c: "He is very mad" },
                { s: "feel / I / lonely / here", c: "I feel lonely here" },
                { s: "of / movie? / Are /you / the / afraid", c: "Are you afraid of the movie?" }
            ]
        },
        "10th - Unit 1 (Part 2)": {
            english: ["Cheer up", "Congratulations", "Way to go", "Calm down", "Take it easy", "Relax"],
            meanings: ["Become happier.","Well done.","Enthusiastic praise.","Stop being angry.","Relax.","Become calm."],
            sentences: [
                { s: "Please / cheer / up", c: "Please cheer up" },
                { s: "I / say / congratulations", c: "I say congratulations" },
                { s: "Way / to / go", c: "Way to go" },
                { s: "Please / calm / down", c: "Please calm down" },
                { s: "Just / take / it / easy", c: "Just take it easy" },
                { s: "Now / you / relax", c: "Now you relax" }
            ]
        },
        "11th - Unit 1 (Part 1)": {
            english: ["Celebration", "Costumes", "Terrific", "Take part in", "Well-known", "Be filled with"],
            meanings: ["Social event to celebrate.","Clothes typical of a period.","Wonderful or fantastic.","Participate in an activity.","Famous or familiar.","Contain a lot of something."],
            sentences: [
                { s: "is / This / a / great / celebration. / birthday", c: "This is a great birthday celebration." },
                { s: "the / In / you / carnaval / your / customes. / wear", c: "In the carnaval you wear your costumes." },
                { s: "is / That / terrific! / new", c: "That new is terrific!" },
                { s: "take / part / in / Please / the / run.", c: "Please take part in the run." },
                { s: "is / It / well-known / song. / a", c: "It is a well-known song." },
                { s: "room / The / filled with / is / joy.", c: "The room is filled with joy." }
            ]
        },
        "11th - Unit 1 (Part 2)": {
            english: ["Call off", "Find out", "Bump into", "Count on", "Look forward to", "Book"],
            meanings: ["Cancel.","Discover.","Meet unexpectedly.","Rely on.","Excited.","Reserve."],
            sentences: [
                { s: "Don't / call / off / the / trip", c: "Don't call off the trip" },
                { s: "I / will / find / out", c: "I will find out" },
                { s: "I / bump / into / you", c: "I bump into you" },
                { s: "I / count / on / you", c: "I count on you" },
                { s: "I / look / forward / to / it", c: "I look forward to it" },
                { s: "Please / book / my / flight", c: "Please book my flight" }
            ]
        }
    };

    let state = { name: "", unit: "", completed: { scrolls: false, quiz: false, chamber: false } };

    function updateUnitList() {
        const nameInput = document.getElementById('studentName').value.trim().toLowerCase();
        const select = document.getElementById('unitSelect');
        const lastSelected = select.value;
        select.innerHTML = "";

        Object.keys(VOCABULARY_DATABASE).forEach(unit => {
            const isDone = nameInput && localStorage.getItem(`${nameInput}-${unit}`);
            const opt = document.createElement('option');
            opt.value = unit;
            opt.innerText = isDone ? `âœ… ${unit} (MASTERED)` : unit;
            if (isDone) {
                opt.style.textDecoration = "line-through";
                opt.style.color = "#888";
            }
            select.appendChild(opt);
        });
        
        if (lastSelected && VOCABULARY_DATABASE[lastSelected]) select.value = lastSelected;
        checkUnitStatus();
    }

    function checkUnitStatus() {
        const name = document.getElementById('studentName').value.trim().toLowerCase();
        const unit = document.getElementById('unitSelect').value;
        const btn = document.getElementById('enterBtn');
        const msg = document.getElementById('statusMsg');

        if (name && unit && localStorage.getItem(`${name}-${unit}`)) {
            btn.disabled = true;
            msg.innerText = "QUEST ALREADY COMPLETED";
        } else {
            btn.disabled = false;
            msg.innerText = "";
        }
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
        document.getElementById('screen-' + id).classList.remove('hidden');
        if(id === 'menu') {
            if(state.completed.scrolls) document.getElementById('seal-scrolls').classList.remove('hidden');
            if(state.completed.quiz) document.getElementById('seal-quiz').classList.remove('hidden');
            if(state.completed.chamber) document.getElementById('seal-chamber').classList.remove('hidden');
        }
    }

    function startPortal() {
        state.name = document.getElementById('studentName').value.trim();
        state.unit = document.getElementById('unitSelect').value;
        if (!state.name) return alert("Identify yourself, Wizard!");
        document.getElementById('welcome-msg').innerText = "Greetings, " + state.name;
        showScreen('menu');
    }

    function startActivity(type) {
        showScreen('activity');
        const cont = document.getElementById('activity-content');
        const data = VOCABULARY_DATABASE[state.unit];

        if(type === 'scrolls') {
            let i = 0;
            const render = () => {
                cont.innerHTML = `<h3>Scroll ${i+1} / ${data.english.length}</h3>
                    <div class="flashcard" onclick="this.classList.toggle('flipped')">
                        <div class="flashcard-inner">
                            <div class="front"><h3>${data.english[i]}</h3></div>
                            <div class="back"><p>${data.meanings[i]}</p></div>
                        </div>
                    </div>
                    <button class="btn" id="nextF">${i === data.english.length - 1 ? 'Unlock Menu' : 'Next Scroll'}</button>`;
                document.getElementById('nextF').onclick = () => {
                    if(i < data.english.length - 1) { i++; render(); }
                    else { state.completed.scrolls = true; showScreen('menu'); }
                };
            };
            render();
        }

        if(type === 'quiz') {
            let i = 0;
            const renderQ = () => {
                let word = data.english[i];
                let correct = data.meanings[i];
                let opts = [...data.meanings].sort(()=>0.5-Math.random()).slice(0,3);
                if(!opts.includes(correct)) opts[0] = correct;
                opts.sort();
                cont.innerHTML = `<h3 style="font-size:1.5rem;">Match definition for:</h3><h2 style="font-size:3rem; margin:15px;">${word}</h2><div id="ql"></div>`;
                opts.forEach(o => {
                    let d = document.createElement('div'); d.className = 'quiz-option'; d.innerText = o;
                    d.onclick = () => {
                        if(o === correct) {
                            d.classList.add('correct');
                            setTimeout(() => { i++; i < data.english.length ? renderQ() : (state.completed.quiz = true, showScreen('menu')); }, 1000);
                        } else d.classList.add('wrong');
                    };
                    document.getElementById('ql').appendChild(d);
                });
            };
            renderQ();
        }

        if(type === 'chamber') {
            let i = 0;
            const renderC = () => {
                let sData = data.sentences[i];
                cont.innerHTML = `<h3>Unscramble Spell ${i+1} / ${data.sentences.length}</h3><p style="font-size:1.5rem; color:#666;">${sData.s}</p>
                    <input type="text" id="sin" placeholder="Cast sentence..." style="width:100%; margin:25px 0;">
                    <button class="btn" id="cbtn">Release Magic</button>`;
                document.getElementById('cbtn').onclick = () => {
                    if(document.getElementById('sin').value.trim().toLowerCase() === sData.c.toLowerCase()) {
                        i++; i < data.sentences.length ? renderC() : (state.completed.chamber = true, showScreen('menu'));
                    } else alert("Try again!");
                };
            };
            renderC();
        }
    }

    function generateCertificate() {
        if(!state.completed.scrolls || !state.completed.quiz || !state.completed.chamber) return alert("Complete all tasks!");
        localStorage.setItem(`${state.name.toLowerCase()}-${state.unit}`, "completed");
        document.getElementById('cert-name').innerText = state.name;
        document.getElementById('cert-unit').innerText = state.unit;
        document.getElementById('cert-date').innerText = "Awarded: " + new Date().toLocaleDateString();
        document.getElementById('cert-code').innerText = "CODE: " + Math.random().toString(36).substr(2, 9).toUpperCase();
        showScreen('certificate');
    }
    updateUnitList();
</script>
</body>
</html>
