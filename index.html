<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pazport to English | Slytherin Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=EB+Garamond:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --slytherin-green: #1A472A;
            --slytherin-silver: #AAAAAA;
            --deep-black: #111111;
            --parchment: #F5F5DC;
            --light-parchment: #FFFEF7;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'EB Garamond', serif;
            background-color: var(--deep-black);
            background-image: url('https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-blend-mode: multiply;
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 1000px;
            margin: 20px auto;
            background-color: var(--parchment);
            border: 8px solid var(--slytherin-green);
            box-shadow: 0 20px 50px rgba(0,0,0,0.7);
            border-radius: 8px;
            overflow: hidden;
        }

        .screen { min-height: 70vh; padding: 30px; text-align: center; }
        .hidden { display: none !important; }

        h1, h2, h3 { font-family: 'Cinzel', serif; color: var(--slytherin-green); margin-bottom: 20px; }
        h1 { font-size: 2.8rem; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }

        .input-group { margin: 20px 0; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto; }
        .input-group label { display: block; font-family: 'Cinzel', serif; margin-bottom: 8px; color: var(--slytherin-green); font-weight: bold; }
        
        input[type="text"], select {
            width: 100%; padding: 15px; border: 3px solid var(--slytherin-green);
            background: var(--light-parchment); border-radius: 4px; font-size: 1.1rem;
        }

        .btn {
            display: inline-block; padding: 16px 32px;
            background: linear-gradient(to bottom, var(--slytherin-green), #0d2b1a);
            color: var(--slytherin-silver) !important;
            border: 2px solid var(--slytherin-silver);
            border-radius: 4px; font-family: 'Cinzel', serif;
            font-weight: 700; cursor: pointer; text-transform: uppercase;
            box-shadow: 0 4px 0 #000; transition: 0.2s;
        }

        .btn:active { transform: translateY(2px); box-shadow: 0 2px 0 #000; }
        .btn:disabled { background: #555; cursor: not-allowed; opacity: 0.6; box-shadow: none; }

        .activity-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-top: 30px; }
        .activity-card {
            background: var(--light-parchment); border: 4px solid var(--slytherin-green);
            padding: 25px; border-radius: 8px; cursor: pointer; transition: 0.3s;
        }
        .activity-card:hover { transform: scale(1.03); background: #eee; }

        /* FLASHCARDS VISIBILITY FIX */
        .flashcard { width: 100%; max-width: 450px; height: 300px; margin: 20px auto; perspective: 1000px; cursor: pointer; }
        .flashcard-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
        .front, .back {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-radius: 10px; border: 6px solid var(--slytherin-silver); padding: 25px;
        }
        .front { background-color: var(--slytherin-green); color: #CCCCCC !important; }
        .front h3 { font-size: 2.2rem; text-align: center; }
        .back { background-color: var(--slytherin-silver); color: var(--slytherin-green); transform: rotateY(180deg); }
        .back p { font-size: 1.3rem; font-weight: bold; line-height: 1.4; text-align: center; }

        .quiz-option {
            background: var(--light-parchment); border: 2px solid var(--slytherin-green);
            padding: 14px; margin: 10px auto; max-width: 650px; cursor: pointer; border-radius: 8px; transition: 0.2s;
        }
        .correct { background: #d4edda !important; border-color: #28a745 !important; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; }

        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .flashcard { height: 280px; }
            .front h3 { font-size: 1.8rem; }
            .back p { font-size: 1.1rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <section id="screen-home" class="screen">
        <i class="fas fa-snake" style="font-size: 3.5rem; color: var(--slytherin-green);"></i>
        <h1>Pazport to English</h1>
        <p>Master the language, master the world.</p>
        
        <div class="input-group">
            <label>Student Full Name</label>
            <input type="text" id="studentName" placeholder="Enter your name..." oninput="updateUnitList()">
        </div>
        
        <div class="input-group">
            <label>Select Your Quest</label>
            <select id="unitSelect" onchange="checkUnitStatus()"></select>
        </div>
        
        <button class="btn" id="enterBtn" onclick="startPortal()">Enter the Common Room</button>
        <p id="statusMsg" style="margin-top:15px; font-weight:bold; color:var(--slytherin-green);"></p>
    </section>

    <section id="screen-menu" class="screen hidden">
        <h2 id="welcome-msg">Slytherin Room</h2>
        <div class="activity-grid">
            <div class="activity-card" onclick="startActivity('scrolls')">
                <i class="fas fa-scroll" style="font-size: 2.5rem; color: var(--slytherin-green);"></i>
                <h3>Study Scrolls</h3>
            </div>
            <div class="activity-card" onclick="startActivity('quiz')">
                <i class="fas fa-vial" style="font-size: 2.5rem; color: var(--slytherin-green);"></i>
                <h3>Definition Quiz</h3>
            </div>
            <div class="activity-card" onclick="startActivity('chamber')">
                <i class="fas fa-wand-sparkles" style="font-size: 2.5rem; color: var(--slytherin-green);"></i>
                <h3>Sentence Chamber</h3>
            </div>
        </div>
        <button class="btn" onclick="generateCertificate()" style="margin-top: 50px;">Claim Official Report</button>
    </section>

    <section id="screen-activity" class="screen hidden">
        <div style="text-align: left; margin-bottom: 20px;">
            <button class="btn" onclick="showScreen('menu')" style="padding: 10px 20px;">Return</button>
        </div>
        <div id="activity-content"></div>
    </section>

    <section id="screen-certificate" class="screen hidden">
        <div id="cert-area" style="border: 12px double var(--slytherin-green); padding: 40px; background: white;">
            <h1>Mastery Achievement</h1>
            <p>This recognizes that</p>
            <h2 id="cert-name" style="text-decoration: underline; margin: 15px 0; font-size: 2.2rem;"></h2>
            <p>has successfully conquered the skills of</p>
            <h3 id="cert-unit" style="margin: 10px 0; color: var(--slytherin-green);"></h3>
            <p id="cert-date" style="font-style: italic;"></p>
            <div style="margin-top:20px; font-family:monospace; border:1px dashed #ccc; padding:5px;" id="cert-code"></div>
        </div>
        <button class="btn" onclick="location.reload()" style="margin-top: 25px;">Save & Return to Hall</button>
    </section>
</div>

<script>
    // ==========================================
    // TEACHER'S OFFICE: COMPLETE DATABASE
    // ==========================================
    const VOCABULARY_DATABASE = {
        "9th - Unit 1 (Part 1)": {
            english: ["Department Store", "Baseball Cap", "Clerk", "Straight", "Upstairs", "Toward"],
            meanings: [
                [cite_start]"A large shop divided into several parts selling different things[cite: 13].",
                [cite_start]"A soft hat with a stiff part extending over the eyes[cite: 13].",
                [cite_start]"A person who works in a shop, office, or bank[cite: 13].",
                [cite_start]"Continuing in one direction without bending or curving[cite: 13].",
                [cite_start]"Towards or on the highest floor of a building[cite: 13].",
                [cite_start]"In the direction of someone or something[cite: 13]."
            ],
            sentences: [
                { s: "buy / I / clothes / at / the / department store", c: "I buy clothes at the department store" },
                { s: "wearing / is / a / red / baseball cap / He", c: "He is wearing a red baseball cap" },
                { s: "The / clerk / me / helped / in / the / shop", c: "The clerk helped me in the shop" },
                { s: "Go / and / turn / straight / left", c: "Go straight and turn left" },
                { s: "The / is / upstairs / bedroom", c: "The bedroom is upstairs" },
                { s: "Walk / toward / the / library / slowly", c: "Walk toward the library slowly" }
            ]
        },
        "9th - Unit 1 (Part 2)": {
            english: ["Glove", "Terrible", "Direction", "Basement", "Food Court", "Restroom"],
            meanings: [
                [cite_start]"Clothing that covers the hand and fingers[cite: 13].",
                [cite_start]"Very unpleasant or serious[cite: 13].",
                [cite_start]"The path that something takes[cite: 13].",
                [cite_start]"The part of a building below ground level[cite: 13].",
                [cite_start]"Area in a mall with many small restaurants[cite: 13].",
                [cite_start]"A room with a toilet in a public building[cite: 13]."
            ],
            sentences: [
                { s: "wear / I / gloves / when / it / is / cold", c: "I wear gloves when it is cold" },
                { s: "The / weather / was / terrible / yesterday", c: "The weather was terrible yesterday" },
                { s: "Which / is / direction / the / bank / in?", c: "Which direction is the bank in?" },
                { s: "Go / down / to / the / basement / now", c: "Go down to the basement now" },
                { s: "Let's / meet / at / the / food court", c: "Let's meet at the food court" },
                { s: "Where / is / the / public / restroom?", c: "Where is the public restroom?" }
            ]
        },
        "10th - Unit 1 (Part 1)": {
            english: ["Nervous", "Proud", "Jealous", "Mad", "Lonely", "Afraid"],
            meanings: [
                "Feeling worried or anxious.",
                "Feeling pleased about something you did.",
                "Unhappy because someone has what you want.",
                "Feeling very angry.",
                "Unhappy because you are not with other people.",
                "Feeling fear or worried about a possible result."
            ],
            sentences: [
                { s: "nervous / about / am / I / the / speech", c: "I am nervous about the speech" },
                { s: "parents / My / are / proud / of / me", c: "My parents are proud of me" },
                { s: "Do / not / be / jealous / of / her", c: "Do not be jealous of her" },
                { s: "He / was / mad / the / at / president", c: "He was mad at the president" },
                { s: "feels / She / lives / and / lonely / often / alone", c: "She lives alone and often feels lonely."},
                { s: "dark / of / the / afraid / He / is", c: "He is afraid of the dark."}
            ]
        },
        "10th - Unit 1 (Part 2)": {
            english: ["Cheer up", "Congratulations", "Way to go", "Calm down", "Take it easy", "Relax"],
            meanings: [
                "Expression to make someone feel happier.",
                "Phrase used when someone has done well.",
                "Enthusiastic way to say 'well done'.",
                "To stop feeling angry or excited.",
                "Used to tell someone to be calm.",
                "To become less active and more calm."
            ],
            sentences: [
                { s: "Please / cheer / up / it / is / okay", c: "Please cheer up it is okay" },
                { s: "Congratulations / on / your / good / grade", c: "Congratulations on your good grade" },
                { s: "Way / to / go / on / the / test", c: "Way to go on the test" },
                { s: "You / need / to / calm / down / now", c: "You need to calm down now" },
                { s: "Take / it / easy / and / breathe / slowly", c: "Take it easy and breathe slowly" },
                { s: "Try / to / and / relax / listen / music", c: "Try to relax and listen music" }
            ]
        },
        "11th - Unit 1 (Part 1)": {
            english: ["Celebration", "Costumes", "Terrific", "Take part in", "Well-known", "Be filled with"],
            meanings: [
                "Special social event to celebrate.",
                "Clothes worn typical of a period.",
                "Very good; wonderful or fantastic.",
                "To be involved in an activity.",
                "Famous or familiar to many people.",
                "To contain a lot of something."
            ],
            sentences: [
                { s: "The / party / was / a / celebration", c: "The party was a celebration" },
                { s: "wore / They / costumes / for / carnival", c: "They wore costumes for carnival" },
                { s: "had / a / We / terrific / time", c: "We had a terrific time" },
                { s: "I / want / to / take part in / the / race", c: "I want to take part in the race" },
                { s: "He / is / a / well-known / singer", c: "He is a well-known singer" },
                { s: "The / streets / were / filled with / people", c: "The streets were filled with people" }
            ]
        },
        "11th - Unit 1 (Part 2)": {
            english: ["Call off", "Find out", "Bump into", "Count on", "Look forward to", "Book"],
            meanings: [
                "To cancel something planned.",
                "To discover a piece of information.",
                "To meet someone unexpectedly.",
                "To rely on someone for help.",
                "To feel excited about the future.",
                "To reserve a seat or hotel."
            ],
            sentences: [
                { s: "They / had / to / call / off / the / festival", c: "They had to call off the festival" },
                { s: "I / to / find / out / need / the / date", c: "I need to find out the date" },
                { s: "I / into / bumped / Jenny / at / the / library", c: "I bumped into Jenny at the library" },
                { s: "You / can / always / count / on / me", c: "You can always count on me" },
                { s: "I / look / forward / to / the / party", c: "I look forward to the party" },
                { s: "booked / Pedro / a / home / flight", c: "Pedro booked a flight home" }
            ]
        }
    };

    let state = { name: "", unit: "", completed: { scrolls: false, quiz: false, chamber: false } };

    // --- LOGIC: MEMORY & LOCKING ---
    function updateUnitList() {
        const name = document.getElementById('studentName').value.trim().toLowerCase();
        const select = document.getElementById('unitSelect');
        select.innerHTML = "";

        Object.keys(VOCABULARY_DATABASE).forEach(unit => {
            const isDone = localStorage.getItem(`${name}-${unit}`);
            const opt = document.createElement('option');
            opt.value = unit;
            opt.innerText = isDone ? `✅ ${unit} (DONE)` : unit;
            if (isDone) {
                opt.style.textDecoration = "line-through";
                opt.style.color = "#888";
            }
            select.appendChild(opt);
        });
        checkUnitStatus();
    }

    function checkUnitStatus() {
        const name = document.getElementById('studentName').value.trim().toLowerCase();
        const unit = document.getElementById('unitSelect').value;
        const btn = document.getElementById('enterBtn');
        const msg = document.getElementById('statusMsg');

        if (name && localStorage.getItem(`${name}-${unit}`)) {
            btn.disabled = true;
            msg.innerText = "⚠️ You have already mastered this quest!";
        } else {
            btn.disabled = false;
            msg.innerText = "";
        }
    }

    // Inicializar lista
    updateUnitList();

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
        document.getElementById('screen-' + id).classList.remove('hidden');
    }

    function startPortal() {
        state.name = document.getElementById('studentName').value.trim();
        state.unit = document.getElementById('unitSelect').value;
        if (!state.name) return alert("Who are you? State your name.");
        document.getElementById('welcome-msg').innerText = "Greetings, " + state.name;
        showScreen('menu');
    }

    function startActivity(type) {
        showScreen('activity');
        const cont = document.getElementById('activity-content');
        const data = VOCABULARY_DATABASE[state.unit];

        if(type === 'scrolls') {
            let i = 0;
            const render = () => {
                cont.innerHTML = `
                    <h2>Word ${i+1} / ${data.english.length}</h2>
                    <div class="flashcard" onclick="this.classList.toggle('flipped')">
                        <div class="flashcard-inner">
                            <div class="front"><h3>${data.english[i]}</h3></div>
                            <div class="back"><p>${data.meanings[i]}</p></div>
                        </div>
                    </div>
                    <button class="btn" id="nextF">${i === data.english.length - 1 ? 'Complete Study' : 'Next Scroll'}</button>
                `;
                document.getElementById('nextF').onclick = () => {
                    if(i < data.english.length - 1) { i++; render(); }
                    else { state.completed.scrolls = true; showScreen('menu'); }
                };
            };
            render();
        }

        if(type === 'quiz') {
            let i = 0;
            const renderQ = () => {
                let word = data.english[i];
                let correct = data.meanings[i];
                let opts = [...data.meanings].sort(()=>0.5-Math.random()).slice(0,3);
                if(!opts.includes(correct)) opts[0] = correct;
                opts.sort();
                cont.innerHTML = `<h2>Match the definition for:</h2><h3 style="font-size:2rem; margin:15px;">${word}</h3><div id="ql"></div>`;
                opts.forEach(o => {
                    let d = document.createElement('div'); d.className = 'quiz-option'; d.innerText = o;
                    d.onclick = () => {
                        if(o === correct) {
                            d.classList.add('correct');
                            setTimeout(() => { i++; i < data.english.length ? renderQ() : (state.completed.quiz = true, showScreen('menu')); }, 1000);
                        } else {
                            d.classList.add('wrong');
                            alert("Incorrect! Review your scrolls.");
                        }
                    };
                    document.getElementById('ql').appendChild(d);
                });
            };
            renderQ();
        }

        if(type === 'chamber') {
            let i = 0;
            const renderC = () => {
                let sData = data.sentences[i];
                cont.innerHTML = `
                    <h2>The Sentence Chamber</h2>
                    <p>Unscramble the spell:</p>
                    <h3 style="margin:25px 0; color:var(--slytherin-green);">${sData.s}</h3>
                    <input type="text" id="sin" placeholder="Type the full sentence here..." style="width:100%; margin-bottom:20px;">
                    <button class="btn" id="cbtn">Cast Spell</button>
                `;
                document.getElementById('cbtn').onclick = () => {
                    if(document.getElementById('sin').value.trim().toLowerCase() === sData.c.toLowerCase()) {
                        i++; i < data.sentences.length ? renderC() : (state.completed.chamber = true, showScreen('menu'));
                    } else alert("The magic failed. Check word order!");
                };
            };
            renderC();
        }
    }

    function generateCertificate() {
        if(!state.completed.scrolls || !state.completed.quiz || !state.completed.chamber) {
            return alert("Access Denied. You must complete all three tasks first!");
        }
        
        // --- SAVE PROGRESS PERMANENTLY ---
        localStorage.setItem(`${state.name.toLowerCase()}-${state.unit}`, "completed");
        
        document.getElementById('cert-name').innerText = state.name;
        document.getElementById('cert-unit').innerText = state.unit;
        document.getElementById('cert-date').innerText = "Date of Mastery: " + new Date().toLocaleDateString();
        document.getElementById('cert-code').innerText = "VERIFICATION CODE: " + Math.random().toString(36).substr(2, 9).toUpperCase();
        showScreen('certificate');
    }
</script>
</body>
</html>
